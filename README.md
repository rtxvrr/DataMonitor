# DataMonitor (Demo Application)

Это демо-приложение WPF, разработанное в рамках тестового задания для компании Северсталь.  
Оно демонстрирует следующие возможности:
- Асинхронный вывод данных из базы данных в приложение.
- Построение различных графиков (столбчатых и линейных)
- Добавление новых записей.
- Асинхронное логирование (разделение на события и ошибки).
- Асинхронное чтение файла в фоновом режиме.
- Использование EF Core с готовой БД.

## Как развернуть проект

1. **Развернуть базу данных**  
   - У вас есть два варианта:
     1. **Развернуть бэкап**  
        В папке DataBase import лежит бекап базы данных (DataMonitor.bak). В SQL Server Management Studio разверните бэкап с этим именем. В этом варианте у вас сразу будут тестовые данные.
     2. **Создать БД вручную скриптом**  
        В папке DataBase import находится T-SQL-скрипт для создания таблиц (Machine, MachineRecord, Log, LogType). 
   - Самое главное условие: в таблице `LogType` должны присутствовать **две** записи:
     - `ID = 1, TypeTitle = 'EVENT'`
     - `ID = 2, TypeTitle = 'ERROR'`
   Это необходимо для логирования событий и ошибок.  
     
2. **Настроить строку подключения**  
   - В файле **appsettings.json** замените `Data Source=...` и `Initial Catalog=...` на ваши локальные настройки SQL Server. Если разварачиваете локально, и наименование БД DataMonitor, то проблем быть не должно, и менять ничего не придется.
   - Пример:  
     ```json
     {
       "ConnectionStrings": {
         "DataMonitorConnection": "Data Source=localhost\\SQLEXPRESS;Initial Catalog=DataMonitor;Integrated Security=True;TrustServerCertificate=True;"
       }
     }
     ```  
   - Если используете SQL-пользователя, добавьте `User ID=...;Password=...;`.

3. **Собрать и запустить проект**  
   - Откройте решение в Visual Studio 2022 и запустите проект. 

## Как работать с приложением
1. **Главное окно**  
   - При успешной инициализации окна это залогируется в таблицу Log.
   - Таблица с данными (`MachineRecord`)
   - Выпадающий список для переключения разных графиков (LiveCharts).
   - Кнопка «Вызвать ошибку» создаст ошибку, приложение обработает эту ошибку, залогирует в БД и оповестит пользователя.
   - Кнопка «Добавить запись» — открывает окно для добавления новой записи.  

2. **Добавление записи**  
   - Пользователь может выбрать существующий номер машины из выпадающего списка или ввести новый, при этом при сохранении создаётся новая запись в таблице `Machine`, если она отсутствует.  
   - Затем формируется запись в таблице `MachineRecord`.  
   - Операция логируется в таблице `Log`.

3. **Чтение файла**  
   - Нажмите «Прочитать файл», выберите любой `.txt` файл. Он будет прочитан асинхронно, содержимое отобразится в окне, и вы получите всплывающее уведомление о статусе операции.  

4. **Логирование**  
   - Все события и ошибки записываются в таблицу `Log` (связь по `LogTypeID`). В случае ошибки ID = 2 (ERROR), при успешных событиях ID = 1 (EVENT).   

![image](https://github.com/user-attachments/assets/303e769f-7b74-4afe-af3e-543f9db78eb3)
